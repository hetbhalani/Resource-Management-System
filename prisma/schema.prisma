generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model bookings {
  booking_id                        Int       @id @default(autoincrement())
  resource_id                       Int
  user_id                           Int
  start_datetime                    DateTime  @db.Timestamp(6)
  end_datetime                      DateTime  @db.Timestamp(6)
  status                            String    @db.VarChar(20)
  approver_id                       Int?
  created_at                        DateTime? @default(now()) @db.Timestamp(6)
  users_bookings_approver_idTousers users?    @relation("bookings_approver_idTousers", fields: [approver_id], references: [user_id], onUpdate: NoAction, map: "fk_booking_approver")
  resources                         resources @relation(fields: [resource_id], references: [resource_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_booking_resource")
  users_bookings_user_idTousers     users     @relation("bookings_user_idTousers", fields: [user_id], references: [user_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_booking_user")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model buildings {
  building_id     Int         @id @default(autoincrement())
  building_name   String      @db.VarChar(100)
  building_number String?     @db.VarChar(50)
  total_floors    Int?
  resources       resources[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model cupboards {
  cupboard_id   Int       @id @default(autoincrement())
  resource_id   Int
  cupboard_name String    @db.VarChar(100)
  total_shelves Int?
  resources     resources @relation(fields: [resource_id], references: [resource_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_cupboard_resource")
  shelves       shelves[]
}

model facilities {
  facility_id   Int       @id @default(autoincrement())
  resource_id   Int
  facility_name String    @db.VarChar(100)
  details       String?
  resources     resources @relation(fields: [resource_id], references: [resource_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_facility_resource")
}

model maintenance {
  maintenance_id   Int       @id @default(autoincrement())
  resource_id      Int
  maintenance_type String    @db.VarChar(100)
  scheduled_date   DateTime  @db.Date
  status           String    @db.VarChar(20)
  notes            String?
  resources        resources @relation(fields: [resource_id], references: [resource_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_maintenance_resource")
}

model resource_types {
  resource_type_id Int         @id @default(autoincrement())
  type_name        String      @unique @db.VarChar(100)
  resources        resources[]
}

model resources {
  resource_id      Int            @id @default(autoincrement())
  resource_name    String         @db.VarChar(100)
  resource_type_id Int
  building_id      Int
  floor_number     Int?
  description      String?
  bookings         bookings[]
  cupboards        cupboards[]
  facilities       facilities[]
  maintenance      maintenance[]
  buildings        buildings      @relation(fields: [building_id], references: [building_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_building")
  resource_types   resource_types @relation(fields: [resource_type_id], references: [resource_type_id], onUpdate: NoAction, map: "fk_resource_type")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model shelves {
  shelf_id     Int       @id @default(autoincrement())
  cupboard_id  Int
  shelf_number Int
  capacity     Int?
  description  String?
  cupboards    cupboards @relation(fields: [cupboard_id], references: [cupboard_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_shelf_cupboard")

  @@unique([cupboard_id, shelf_number], map: "uq_cupboard_shelf")
}

model users {
  user_id                              Int        @id @default(autoincrement())
  name                                 String     @db.VarChar(100)
  email                                String     @unique @db.VarChar(100)
  role                                 String     @db.VarChar(20)
  password                             String     @db.VarChar(255)
  created_at                           DateTime?  @default(now()) @db.Timestamp(6)
  bookings_bookings_approver_idTousers bookings[] @relation("bookings_approver_idTousers")
  bookings_bookings_user_idTousers     bookings[] @relation("bookings_user_idTousers")
}
